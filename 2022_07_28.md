# Spring(인프런) - Spring MVC-2 메시지, 국제화

## 메세지, 국제화
- 각각의 HTML파일에서 메시지가 하드코딩 되어있는 상태를 한 곳에서 관리하도록 하는 기능을 메시지 기능이라고 한다
- 메시지 기능을 각 나라별로 별도 관리하는 서비스를 국제화라고 한다

## 웹 애플리케이션에 메시지 적용해보기
- 상품 등록하는 메시지 애플리케이션이 있다고 예를 들어보자
- properties 파일을 만들어 메시지를 한곳에 추가해보자
- 예를 들어 타임리프로 만든 뷰 파일에 적용을 한다
```
<div th:text="#{label.item}"></h2>
```
- 위와 같은 방식으로 메시지 파일을 편리하게 조회할 수 있다.

## 국제화 적용하기
- 국제화를 적용하려면 국제화 메시지 파일을 만들어 놓고 동일하게 메시지와 동일하게 조회하는 방법을 사용한다.
- 스프링의 국제화 메시지는 Local 정보를 알아야 언어를 선택할 수 있는데, Accept-Language의 헤더값을 사용한다
- Accept-Language 는 클라이언트가 서버에 기대하는 언어정보를 담아서 요청하는 HTTP 요청 헤더이다.
- 스프링은 Locale 선택 방식을 변경할 수 있도록 LocaleResolver라는 인터페이스를 제공한다.
- 스프링부트는 Accept-Language를 활용하는 AcceptHeaderLocaleResolver를 사용한다

# Spring(인프런) - Spring MVC-2 Validation #1

## 검증
- 웹 서비스는 폼 입력 오류 시 데이터를 유지한 상태로 어떤 오류가 발생한지 알려줘야 한다
- 컨트롤러의 중요한 역할 중 하나는 HTTP 요청이 정상인지 검증하는 것이다.
- 클라이언트 검증과 서버 검증을 적절히 사용하여 사용한다 -> 서버 검증은 최종적으로 필수

## 오류 코드와 메시지 처리
- 오류 코드를 만들 때는 자세하게 만들거나 단순하게 만드는 방법을 섞어서 사용하는 것이다
- 단순한 메세지(덜 자세한)을 평소에 사용하다가 세밀한 메시지가 필요한 순간에 세밀한 내용이 적용되도록 사용
- 오류 코드 사용의 예
```
required : 필수 값 입니다.
required.box.boxName : 상자 이름은 필수 값 입니다.
```
- 스프링은 MessageCodeResolver 기능을 이용하여 위에 말한 동작을 지원한다
- MessageCodeResolver
    - 검증 오류 코드로 메시지 코드를 생성한다
    - MessageCodeResolver 인터페이스고 DefaltMessageCodeResolver는 기본 구현체이다
    - ObjectError, FieldError와 함께 사용되는 경우가 많다
- DefaultMessageCodesResolver의 기본 메시지 생성 규칙
```
객체 오류의 경우 다음 순서로 2가지 생성
1.: code + "." + object name
2.: code
예) 오류 코드: required, object name: item
1.: required.item
2.: required

필드 오류의 경우 다음 순서로 4가지 메시지 코드 생성
1.: code + "." + object name + "." + field
2.: code + "." + field
3.: code + "." + field type
4.: code
예) 오류 코드: typeMismatch, object name "user", field "age", field type: int
1. "typeMismatch.user.age"
2. "typeMismatch.age"
3. "typeMismatch.int"
4. "typeMismatch"
```

## 스프링이 직접 만든 오류 메시지 처리
- 검증 오류 코드
    - 개발자가 직접 오류 코드 설정 -> rejectValue() 직접 호출
    - 스프링이 직접 검증 오류에 추가한 경우(주로 타입 정보가 맞지 않다)
