# 쿠버네티스

## Kubernetes 노드 네트워크 기본

### 노드별 기본 조건
- 마스터와 워커 노드 각각 최소 하나의 네트워크 인터페이스와 고유 IP 필요
- 호스트명(hostname)과 MAC 주소도 각각 고유해야 함 (VM 복제 시 특히 주의)
- 인터페이스에 올바른 주소가 설정되어 있어야 클러스터 통신 가능

### 필수 개방 포트
- `6443`: API Server (워커, 운영자, kube-control 명령 등 모든 제어면 트래픽)
- `10250`: kubelet (마스터/워커 공통)
- `10259`: kube-scheduler
- `10257`: kube-controller-manager
- `2379`: etcd 클라이언트 → 단일 마스터 또는 외부 클라이언트 접근
- `2380`: etcd 피어 간 통신 (다중 마스터 구성 시)
- `30000-32767`: NodePort 서비스 범위

클러스터가 정상 동작하지 않을 때 위 포트들이 방화벽, iptables, 클라우드 보안 그룹에서 차단되지 않았는지 우선 점검한다.

### 점검 명령어
- `ip link`, `ip addr`: 인터페이스와 IP 확인
- `hostnamectl`, `cat /etc/hostname`: 호스트명 확인
- `ss -tulpn` 또는 `netstat -plnt`: 서비스 리스닝 포트 확인
- `sudo ufw status`, `iptables -L`, 클라우드 콘솔 보안 그룹: 방화벽 규칙 확인

### 실습 가이드
1. 기존 클러스터에서 각 노드에 SSH 접속
2. 인터페이스/주소/호스트명을 위 명령으로 확인
3. `ss -tulpn | grep -E '6443|1025|10259|2379|2380'` 등으로 포트가 열려 있는지 확인
4. 문제가 있을 경우 방화벽이나 클라우드 NSG에서 해당 포트를 허용

이 기본 점검 과정을 익혀 두면 이후 고급 네트워킹 시나리오에서 문제를 빠르게 찾을 수 있다.
