# 쿠버네티스

## OS Upgrades
기반 소프트웨어를 업그레이드 하거나 보안 패치를 적용할 때와 같이 클러스터의 노드를 유지보수의 목적으로 내려야할 상황을 다룬다

### 노드 장애 시 동작
- 노드가 잠시 다운 -> kubelet 재시작 시 pod 복구
- 노드가 5분 이상 다운 -> pod-eviction-timeout(기본 5분) 이후 파드 종료 처리
  - ReplicaSet 소속 파드 -> 다른 노드에서 재생성
  - ReplicaSet 비소속 파드 -> 소멸됨

### 유지보수 전략
- 노드가 5분 내 확실히 복구될 경우 -> 빠른 재부팅 가능
- 불확실할 경우 -> drain 사용
  - pod 안전하게 다른 노드로 이동
  - 해당 노드는 unschedulable 상태로 전환

### 주요 명령어
| 명령어 | 설명 |
|-------|---------|
| cordon | 노드를 unschdulable로 표시. 기존 pod는 유지되지만 새로운 pod는 스케줄 되지 않음 |
| drain | 노드에서 pod를 종료 (다른 노드에서 재생성) + unschedulable 처리 |
| uncordon | 노드의 unschedulable 상태 해제. 다시 pod를 스케줄할 수 있게 함|