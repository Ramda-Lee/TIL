# 쿠버네티스

## In-place Resize of Pods

### 기본 동작
- Kubernetes v1.32 기준
  - Deployment에서 Pod 리소스 변경하면 기존 Pod가 삭제되고 새로운 리소스 정의를 가진 Pod가 생성됨
  - 리소스 변경이 in-place로 적용되지 않음
- 문제점
  - Stateful workload(상태 저장 워크로드)에서는 Pod 종료 -> 새 Pod 생성 과정이 서비스 중단을 유발할 수 있음

### In-place Resizing 기능 개요
- 도입: Kubernetes v1.27 (Alpha)
- 활성화 필요: 기본 비활성롸 -> InPlacePodVerticalScaling=True feature flag 설정 시 사용 가능
- 진행 사항
  - v1.33 기준 여전히 Alpha 단계
  - 향후 Beta -> Stable 단계로 발전 시 기본 활성화 예정
- 지원 대상 리소스:
  - CPU
  - Memory

### Resize Policy
pod 정의에서 리소스별로 변경 시 재시작 필요 여부를 지정할 수 있음
| 리소스 | Resize 정책 | Pod 동작 |
|------|------------|---------|
| CPU  | Restart 불필요 | Pod 종료 없이 리소스가 즉시 업데이트됨 |
| Memory | Restart 필요 | Pod 재시작 후 변경 반영 |

### 제한 사항
| 항목 | 제약 설명 |
|-----|--------------------|
|적용 대상| CPU, Memory만 가능 |
| Pod Qos Class | 변경 불가 |
| Init Containers | 리사이즈 불가 |
| Ephemeral Containers | 리사이즈 불가 |
| 리소스 이동 | Requests/Limits는 한 번 설정되면 다른 리소스로 이동 불가 |
| Memory Limit 감소 | 현재 사용량보다 줄일 수 없음 (줄이려면 상태가 in progress로 유지되며 사용량이 줄어야 적용됨) |
| Windows Pod | 아직 리사이즈 불가 |