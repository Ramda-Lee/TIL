# ì¿ ë²„ë„¤í‹°ìŠ¤

## Rolling Updates and Rollbacks

### Deploymentì™€ Rollout
- Deploymentë¥¼ ìƒì„±í•˜ë©´ Rolloutì´ ìë™ìœ¼ë¡œ íŠ¸ë¦¬ê±°ë¨
- ê° Rolloutì€ ìƒˆë¡œìš´ Recisionì„ ìƒì„±í•¨ (ì˜ˆ: ìµœì†Œ ë°°í¬ëŠ” revision 1, ì´í›„ ì—…ë°ì´íŠ¸ ì‹œ revision 2)
- ê´€ë ¨ ëª…ë ¹ì–´
  ```
    kubectl rollout status <deploymentëª…>: í˜„ì¬ ë¡¤ì•„ì›ƒ ìƒíƒœ í™•ì¸
    kubectl rollout history <deploymentëª…>: ë¡¤ì•„ì›ƒ íˆìŠ¤í† ë¦¬ ë° ë¦¬ë¹„ì „ ëª©ë¡ í™•ì¸
  ```

### ë°°í¬ì „ëµ
#### Recreate ì „ëµ
- ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ëª¨ë‘ ì¢…ë£Œ í›„ ìƒˆë¡œìš´ ë²„ì „ì„ ìƒì„±
- ë‹¨ì : ì¼ì‹œì ìœ¼ë¡œ ì„œë¹„ìŠ¤ ì¤‘ë‹¨

#### RollingUpdate ì „ëµ(ê¸°ë³¸ê°’)
- ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í•˜ë‚˜ì”© ì¢…ë£Œí•˜ê³  ìƒˆë¡œìš´ ë²„ì „ìœ¼ë¡œ ìˆœì°¨ êµì²´
- ì¥ì : ë¬´ì¤‘ë‹¨ ë°°í¬ ê°€ëŠ¥

#### ì „ëµ í™•ì¸ ëª…ë ¹ì–´
```
  kubectl describe deployment <deploymentëª…> # ì´ë²¤íŠ¸ ë¡œê·¸ì—ì„œ ì „ëµ ë°©ì‹ í™•ì¸ ê°€ëŠ¥
```

### ë°°í¬ ì—…ë°ì´íŠ¸ ë°©ë²•
#### yamlíŒŒì¼ì„ í†µí•œ ì ìš©
-  ë°°í¬ íŒŒì¼ ìˆ˜ì • í›„ ì ìš©
```
  kubectl apply -f deployment.yaml
```

#### ëª…ë ¹ì–´ë¡œ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
```
  kubectl set image deployment/<deploymentëª…> <ì»¨í…Œì´ë„ˆëª…>=<ì´ë¯¸ì§€>:<íƒœí¬>
```
- ì£¼ì˜: ì´ ë°©ë²•ì€ yamlíŒŒì¼ê³¼ ì‹¤ì œ ìƒíƒœê°€ ë¶ˆì¼ì¹˜í•  ìˆ˜ ìˆë‹¤.

### ì—…ê·¸ë ˆì´ë“œ ë‚´ë¶€ ë™ì‘ ë°©ì‹
- ë°°í¬ ì‹œ kubernetesëŠ” ReplicaSetì„ ìƒì„±í•˜ê³ , ì´ ReplicaSetì´ Podë¥¼ ê´€ë¦¬
- ìƒˆ ë²„ì „ ë°°í¬ ì‹œ:
  - ìƒˆë¡œìš´ ReplicaSet ìƒì„±
  - ê°€ì¡´ ReplicaSet PodëŠ” í•˜ë‚˜ì”© ì¢…ë£Œ
  - ìƒˆë¡œìš´ ReplicaSet PodëŠ” í•˜ë‚˜ì”© ì‹œì‘
- í™•ì¸ ëª…ë ¹ì–´
```
  kubectl get replicasets
```

### Rollback
- ë¬¸ì œ ë°œìƒ ì‹œ ì´ì „ revisionìœ¼ë¡œ ê°„í¸í•˜ê²Œ ë³µêµ¬ ê°€ëŠ¥
- ë¡¤ë°± ëª…ë ¹ì–´
```
  kubectl rollout nudo deploymnet/<deploymentëª…>
```
- ë¡¤ë°± í›„ ReplicaSet ìƒíƒœ
  - ì´ì „ ReplicaSet: 5 Pod
  - í˜„ì¬(ë¬¸ì œ ìˆëŠ”) ReplicaSet: 0 Pod

### ì£¼ìš” ëª…ë ¹ì–´ ì •ë¦¬
## ğŸ“Œ ì£¼ìš” ëª…ë ¹ì–´ ìš”ì•½

| ëª©ì                | ëª…ë ¹ì–´ ì˜ˆì‹œ                                      |
|--------------------|--------------------------------------------------|
| ë°°í¬ ìƒì„±           | `kubectl create -f deployment.yaml`             |
| ë°°í¬ ëª©ë¡ í™•ì¸       | `kubectl get deployments`                       |
| ë°°í¬ ì ìš© (ì—…ë°ì´íŠ¸) | `kubectl apply -f deployment.yaml`              |
| ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸      | `kubectl set image deployment/<ë°°í¬ëª…> <ì»¨í…Œì´ë„ˆëª…>=<ì´ë¯¸ì§€>:<íƒœê·¸>` |
| ë¡¤ì•„ì›ƒ ìƒíƒœ í™•ì¸     | `kubectl rollout status <deployment>`           |
| ë¡¤ë°± ìˆ˜í–‰           | `kubectl rollout undo deployment/<deployment>`  |
| ReplicaSet í™•ì¸     | `kubectl get replicasets`                       |
| ë°°í¬ ìƒì„¸ ë³´ê¸°       | `kubectl describe deployment <deployment>`      |